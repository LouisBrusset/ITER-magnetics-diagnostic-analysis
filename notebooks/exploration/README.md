# Exploration Notebooks

This directory contains comprehensive exploratory data analysis notebooks for understanding MAST tokamak magnetics diagnostic data. These notebooks provide essential data quality assessment, shot selection criteria, and metadata analysis required for machine learning model development.

## Table of Contents

1. [Overview](#overview)
2. [Notebook Descriptions](#notebook-descriptions)
3. [Key Functions and Classes](#key-functions-and-classes)
4. [Data Analysis Workflows](#data-analysis-workflows)
5. [Usage Examples](#usage-examples)
6. [Data Sources and Outputs](#data-sources-and-outputs)

## Overview

The exploration notebooks focus on four critical aspects of tokamak data analysis:

- **Data Quality Assessment**: Validation of cleaned datasets and preprocessing pipelines
- **Metadata Analysis**: Comprehensive examination of MAST experimental parameters and shot quality
- **Shot Selection**: Development of filtering criteria for high-quality plasma experiments
- **Statistical Analysis**: Variable presence, NaN statistics, and channel distribution analysis

## Notebook Descriptions

### 1. `cleaned_dataframe_opening_test.ipynb`

**Subject**: Validation and testing of cleaned dataframe loading procedures for preprocessed MAST magnetic diagnostic data.

**Purpose**: Ensures data integrity after preprocessing pipeline, validates variable shapes, and confirms proper channel counting for downstream machine learning applications.

### 2. `mast_metadata_analysis.ipynb`

**Subject**: Comprehensive analysis of MAST tokamak experimental metadata for shot quality assessment and campaign statistics.

**Purpose**: Addresses critical research questions: "How many shots in M9 campaign?", "Quality labels for each shot", "Diagnostic-specific quality assessment", and "EFIT++ reconstruction analysis".

### 3. `mast_shots_choice.ipynb`

**Subject**: Development of shot selection criteria and filtering strategies for identifying high-quality MAST tokamak data suitable for machine learning analysis.

**Purpose**: Establishes robust criteria for shot selection, implements parallel data loading strategies, and creates filtered datasets ready for machine learning model training.

### 4. `scrapped_dataframe_analysis.ipynb`

**Subject**: Statistical analysis of scraped and processed tokamak dataframes including variable presence analysis, channel distribution, and data quality assessment.

**Purpose**: Provides comprehensive statistical overview of scraped data, analyzes variable-channel relationships, quantifies NaN statistics, and validates data completeness for machine learning readiness.


## Data Sources and Outputs

### Input Data Sources

- **MAST Cloud Database**: `https://mastapp.site/parquet/level2/shots` - Comprehensive shot metadata
- **MAST Zarr Storage**: `https://s3.echo.stfc.ac.uk/mast/level{level}/shots/{shot}.zarr` - Raw diagnostic data
- **Preprocessed Data**: `data/preprocessed/mscred/data_magnetics_mscred_cleaned.nc` - Cleaned magnetic diagnostics
- **Quality Results**: 
    - `notebooks/result_files/all_shots_magnetics/result_lists_magnetics.json` - Variable and shot selection results based on presence criteria
    - `notebooks/result_files/non_stats_magnetics/result_lists_magnetics_nans.json` - Variables shot selection results based on both presence & NaN statistics.

### Generated Outputs

Some key outputs generated by the notebooks are stored in `notebooks/result_files/`:

**`result_files/efit_analysis`**:
- `coils_in_3d.png` - 3D visualization of magnetic coil positions and geometry
- `efit_analysis.csv` - EFIT++ equilibrium reconstruction analysis results
- `efit_analysis_with_timestamps.csv` - Time-resolved EFIT++ analysis data
- `efit_sensors_seasons.png` - Seasonal analysis of EFIT++ sensor data
- `efit_weights_channels0.png` - Channel weight visualization for first set
- `efit_weights_channels1.png` - Channel weight visualization for second set

**`result_files/spectral_signatures`**:
- `b_field_pol_probe_cc_field_mean_fft.png` - FFT analysis of poloidal field CC probes
- `b_field_pol_probe_cc_field_mean_welch.png` - Welch PSD analysis of poloidal field CC probes
- `b_field_pol_probe_ccbv_field_mean_fft.png` - FFT analysis of poloidal field CCBV probes
- `b_field_pol_probe_ccbv_field_mean_welch.png` - Welch PSD analysis of poloidal field CCBV probes
- `b_field_pol_probe_obr_field_mean_fft.png` - FFT analysis of poloidal field OBR probes
- `b_field_pol_probe_obr_field_mean_welch.png` - Welch PSD analysis of poloidal field OBR probes
- `b_field_pol_probe_obv_field_mean_fft.png` - FFT analysis of poloidal field OBV probes
- `b_field_pol_probe_obv_field_mean_welch.png` - Welch PSD analysis of poloidal field OBV probes
- `b_field_pol_probe_omv_voltage_mean_fft.png` - FFT analysis of poloidal probe OMV voltages
- `b_field_pol_probe_omv_voltage_mean_welch.png` - Welch PSD analysis of poloidal probe OMV voltages
- `b_field_tor_probe_cc_field_mean_fft.png` - FFT analysis of toroidal field CC probes
- `b_field_tor_probe_cc_field_mean_welch.png` - Welch PSD analysis of toroidal field CC probes
- `b_field_tor_probe_saddle_field_mean_fft.png` - FFT analysis of toroidal saddle field probes
- `b_field_tor_probe_saddle_field_mean_welch.png` - Welch PSD analysis of toroidal saddle field probes
- `b_field_tor_probe_saddle_voltage_mean_fft.png` - FFT analysis of toroidal saddle voltages
- `b_field_tor_probe_saddle_voltage_mean_welch.png` - Welch PSD analysis of toroidal saddle voltages
- `flux_loop_flux_mean_fft.png` - FFT analysis of magnetic flux loop measurements
- `flux_loop_flux_mean_welch.png` - Welch PSD analysis of magnetic flux loop measurements
- `ip_mean_fft.png` - FFT analysis of plasma current (Ip) measurements
- `ip_mean_welch.png` - Welch PSD analysis of plasma current (Ip) measurements

**`result_files/non_increasing`**:
- `non_increasing_shot_id.csv` - List of shot IDs with non-increasing time sequences
- `non_increasing_shot_ids_plot.png` - Visualization of non-increasing shot distribution

**`result_files/all_shots_magnetics`**:
- `result_lists_magnetics.json` - Variable and shot selection results based on presence criteria
- `variable_presence_all_shots_magnetics.csv` - Variable availability statistics across all shots
- `variable_presence_magnetics.png` - Visualization of variable presence distribution
- `variable_presence_magnetics_filtered.png` - Filtered variable presence analysis

**`result_files/nan_stats_magnetics`**:
- `nan_stats_per_shot_mscred.csv` - NaN statistics per shot for MSCRED processing
- `result_lists_magnetics_nans.json` - Variable selection results based on both presence and NaN statistics




## Notes

- Parallel processing capabilities enable efficient large-scale data analysis
- Retry mechanisms ensure robust data loading from network sources
- Quality assessment results directly inform machine learning model training data selection